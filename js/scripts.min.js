var flibbble=function(){var a=document.getElementById("flipper"),b,c=function(){document.body.ontouchmove=function(a){a.preventDefault()};d.enable();f.enable();g.enable();h.get("http://api.dribbble.com/shots/popular",{per_page:"20",page:"1"},function(a){e(a)})},d=function(){var a,b=function(b){if(b==="following"||b==="likes"){a||(a=prompt("Dribbble username:"));a&&h.get("http://api.dribbble.com/players/"+a+"/shots/"+b,{per_page:"20",page:"1"},function(a){e(a);g.center()})}else h.get("http://api.dribbble.com/shots/"+b,{per_page:"20",page:"1"},function(a){e(a);g.center()})},c=function(){var a=document.getElementById("popular"),b=document.getElementById("following"),c=document.getElementById("likes"),e=document.getElementById("debuts"),f=document.getElementById("everyone");a.addEventListener("touchstart",function(a){d.to("popular")},!1);b.addEventListener("touchstart",function(a){d.to("following")},!1);c.addEventListener("touchstart",function(a){d.to("likes")},!1);e.addEventListener("touchstart",function(a){d.to("debuts")},!1);f.addEventListener("touchstart",function(a){d.to("everyone")},!1)};return{to:b,enable:c,user:a}}(),e=function(c){var d=c.shots.length,e=document.createDocumentFragment(),g=0,h=3,i=function(){for(;g<d;g++){g===0&&e.appendChild(k(c.shots[0],h));g===d-1&&(d%2===0?e.appendChild(m(c.shots[d-1]),h):e.appendChild(m({},h)));if(g!==0&&g!==d-1){e.appendChild(l(c.shots[g],c.shots[g+1],h));g!==d-2&&g++}h--}},j=function(){a.innerHTML="";f.reset();a.appendChild(e);b=document.getElementsByClassName("page")},k=function(a,b){var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("img"),f=document.createElement("a");c.className="page first";c.style.zIndex=b;d.innerHTML="Loading";d.className="front shot";e.height=240;e.width=320;e.src=a.image_url;e.alt=a.title;d.appendChild(e);c.appendChild(d);return c},l=function(a,b,c){var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("a"),h=document.createElement("a"),i=document.createElement("img"),j=document.createElement("img");d.className="page";e.className="front shot";e.innerHTML="Loading";f.className="back shot";f.innerHTML="Loading";i.height=240;i.width=320;j.height=240;j.width=320;i.src=a.image_url;i.alt=a.title;j.src=b.image_url;j.alt=b.title;c>0?d.style.zIndex=c:d.style.visibility="hidden";e.appendChild(i);f.appendChild(j);d.appendChild(e);d.appendChild(f);return d},m=function(a,b){var c=document.createElement("div"),d=document.createElement("div");c.className="page last";b<1&&(c.style.visibility="hidden");if(a.image_url&&a.title){var e=document.createElement("img"),f=document.createElement("a");d.className="front shot";d.innerHTML="Loading";e.height=240;e.width=320;e.src=a.image_url;e.alt=a.title;d.appendChild(e)}else{d.className="front text";d.innerHTML="END"}c.appendChild(d);return c};i();j()},f=function(){var c,d,e,f,h,i,j=1,k=function(){if(j>2){b[j-3].style.visibility="hidden";b[j-3].style.zIndex=""}if(j>1){b[j-2].style.zIndex=1;b[j-2].style.visibility=""}b[j-1].style.zIndex=2;b.length-j>1&&(b[j+1].style.zIndex=2);b.length-j>2&&(b[j+2].style.cssText="z-index: 1;");b.length-j>3&&(b[j+3].style.cssText="visibility: hidden;")},l=function(a){c=a.targetTouches[0].pageY;d=a.targetTouches[0].pageX;e=0;f=0;h=0;i=(new Date).getTime()},m=function(a){a.preventDefault();e=c-a.targetTouches[0].pageY;f=d-a.targetTouches[0].pageX;if(e>0&&Math.abs(f)<Math.abs(e)){g.disable();if(j<b.length-1){h=Math.min(Math.max((e-20)*.55,0),180);b[j].style.webkitTransition="";b[j].style.webkitTransform="rotateX("+h+"deg)";b[j].style.zIndex=3;if(j===1){b[0].style.webkitTransition="";b[0].style.webkitTransform=""}else b[j-1].style.webkitTransform="rotateX(180deg) translateZ(0)";k()}if(j===b.length-1){h=Math.min(-Math.log(e)*25+75,0);b[j].style.webkitTransition="";b[j].style.webkitTransform="rotateX("+ -h+"deg)"}}if(e<0&&Math.abs(f)<Math.abs(e)){g.disable();if(j!==1){h=Math.max(Math.min((340+e)*.55,180),0);b[j-1].style.webkitTransition="";b[j-1].style.webkitTransform="rotateX("+h+"deg)";b[j-1].style.zIndex=3}if(j===1){h=Math.min(-Math.log(-e)*25+75,0);b[0].style.webkitTransition="";b[0].style.webkitTransform="rotateX("+h+"deg)"}b[j].style.webkitTransform="rotateX(0deg)"}},n=function(a){var c=(new Date).getTime()-i;if(h<0&&e<0&&j===1){b[j-1].style.webkitTransition="all ease-out .6s";b[j-1].style.webkitTransform="rotateX(0deg) translateZ(0)"}if(h>=90&&e<0&&j!==1){b[j-1].style.webkitTransition="all ease-out .6s";b[j-1].style.webkitTransform="rotateX(180deg) translateZ(0)"}if((h>=90||c<300||c>300&&c<800&&e>100&&h<90)&&e>0&&j<b.length-1&&Math.abs(f)<Math.abs(e)){b[j].style.webkitTransition="all ease-out .4s";b[j].style.webkitTransform="rotateX(180deg) translateZ(0)";j++}if(h<90&&e>0&&j!==b.length){b[j].style.webkitTransition="all ease-out .6s";b[j].style.webkitTransform="rotateX(0deg)"}if((h<90||c<300||c>300&&c<800&&e<-100&&h>90)&&e<0&&j!==1&&Math.abs(f)<Math.abs(e)){b[j-1].style.webkitTransition="all ease-out .4s";b[j-1].style.webkitTransform="rotateX(0deg)";j--;k()}i=0;g.enable()},o=function(){a.addEventListener("touchstart",l,!1);a.addEventListener("touchmove",m,!1);a.addEventListener("touchend",n,!1)},p=function(){a.removeEventListener("touchstart",l);a.removeEventListener("touchmove",m);a.removeEventListener("touchend",n)},q=function(){j=1};return{enable:o,disable:p,reset:q}}(),g=function(){var b,c,d,e,g="center",h=function(a){b=a.targetTouches[0].pageY;c=a.targetTouches[0].pageX;d=0;e=0},i=function(a){a.preventDefault();d=b-a.targetTouches[0].pageY;e=c-a.targetTouches[0].pageX},j=function(a){g==="center"&&Math.abs(e)>Math.abs(d)&&e<-100&&k();g==="right"&&Math.abs(e)>Math.abs(d)&&e>0&&l()},k=function(){a.style.webkitTransform="translateX(240px) translateZ(0)";f.disable();g="right"},l=function(){a.style.webkitTransform="translateX(0px) translateZ(0)";f.enable();g="center"},m=function(){a.addEventListener("touchstart",h,!1);a.addEventListener("touchmove",i,!1);a.addEventListener("touchend",j,!1)},n=function(){a.removeEventListener("touchstart",h);a.removeEventListener("touchmove",i);a.removeEventListener("touchend",j)};return{enable:m,disable:n,right:k,center:l}}(),h=function(){function g(a){var c=document.createElement("script"),d=!1;c.src=a;c.async=!0;c.onload=c.onreadystatechange=function(){if(!d&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){d=!0;c.onload=c.onreadystatechange=null;c&&c.parentNode&&c.parentNode.removeChild(c)}};b||(b=document.getElementsByTagName("head")[0]);b.appendChild(c)}function h(a){return encodeURIComponent(a)}function i(b,d,i,j){c=(b||"").indexOf("?")===-1?"?":"&";d=d||{};for(var k in d)d.hasOwnProperty(k)&&(c+=h(k)+"="+h(d[k])+"&");var l="json"+ ++a;e[l]=function(a){i(a);try{delete e[l]}catch(b){}e[l]=null};g(b+c+(j||f.callbackName||"callback")+"="+l);return l}function j(a){f=a}var a=0,b,c,d,e=this,f={};return{get:i,init:j}}();return{init:c}}();document.addEventListener("DOMContentLoaded",flibbble.init);