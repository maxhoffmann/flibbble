var flibbble=function(){var e=document.getElementById("flipper"),t,n=function(){document.body.ontouchmove=function(e){e.preventDefault()};r.enable();r.to("popular");s.enable();o.enable();u.enable()},r=function(){var e="http://api.dribbble.com/shots/popular",t=!1,n=1,s=1,u,f=function(e,t){var n=this;switch(e){case"following":case"likes":u=prompt("dribbble username:",u);if(u){this.url="http://api.dribbble.com/players/"+u+"/shots/"+e;a.get(this.url,{per_page:"20",page:"1"},function(e){i(e);n.page=1;n.maxpage=e.pages;o.center()})}break;default:this.url="http://api.dribbble.com/shots/"+e;a.get(this.url,{per_page:"20",page:"1"},function(e){i(e);n.page=1;n.maxpage=e.pages;o.center()})}},l=function(e){document.getElementsByClassName("active")[0]&&document.getElementsByClassName("active")[0].classList.remove("active");e.classList.add("active")},c=function(){var e=document.getElementById("popular"),t=document.getElementById("following"),n=document.getElementById("likes"),i=document.getElementById("debuts"),s=document.getElementById("everyone");e.addEventListener("touchstart",function(e){r.activate(this);r.to("popular")},!1);t.addEventListener("touchstart",function(e){r.activate(this);r.to("following")},!1);n.addEventListener("touchstart",function(e){r.activate(this);r.to("likes")},!1);i.addEventListener("touchstart",function(e){r.activate(this);r.to("debuts")},!1);s.addEventListener("touchstart",function(e){r.activate(this);r.to("everyone")},!1)},h=function(e){if(!t&&this.page<this.maxpage){t=!0;a.get(this.url,{per_page:"20",page:++this.page},function(e){i(e);t=!1})}};return{to:f,enable:c,more:h,url:e,activate:l}}(),i=function(n){var r=n.shots.length,i=document.createDocumentFragment(),o=0,u=3,a,f=function(){for(;o<r;o++){if(o===0&&n.page===1){i.appendChild(h(n.shots[0],u-1));u++}if(o===0&&n.page>1){a=v(n.shots[0]);u--}o===r-1&&(r%2===0?i.appendChild(d(n.shots[r-1]),u):i.appendChild(d({},u)));if(o!==0&&o!==r-1){i.appendChild(p(n.shots[o],n.shots[o+1],u));o!==r-2&&o++}u--}},l=function(){e.innerHTML="";s.reset();e.appendChild(i);t=document.getElementsByClassName("page")},c=function(){t[t.length-1].appendChild(a);t[t.length-1].classList.remove("last");e.appendChild(i);t=document.getElementsByClassName("page")},h=function(e,t){var n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("img");n.className="page first";n.style.zIndex=t;r.className="front";i.height=240;i.width=320;i.src=e.image_url;i.alt=e.title;i.className="shot";r.appendChild(i);r.innerHTML+='<div class="details hidden"><h2>'+e.title+'</h2><div class="meta"><span class="likes"></span> '+e.likes_count+' <span class="views"></span> '+e.views_count+' <span class="comments"></span> '+e.comments_count+'</div><div class="author"><div class="author-image"><img src="'+e.player.avatar_url+'" height="50"></div><div class="author-name">'+e.player.name+"</div></div></div>";n.appendChild(r);return n},p=function(e,t,n){var r=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("img"),u=document.createElement("img");r.className="page";i.className="front";s.className="back";o.height=240;o.width=320;u.height=240;u.width=320;o.src=e.image_url;o.alt=e.title;u.src=t.image_url;u.alt=t.title;o.className="shot";u.className="shot";n>0?r.style.zIndex=n:r.style.visibility="hidden";i.appendChild(o);s.appendChild(u);i.innerHTML+='<div class="details hidden"><h2>'+e.title+'</h2><div class="meta"><span class="likes"></span> '+e.likes_count+' <span class="views"></span> '+e.views_count+' <span class="comments"></span> '+e.comments_count+'</div><div class="author"><div class="author-image"><img src="'+e.player.avatar_url+'" height="50"></div><div class="author-name">'+e.player.name+"</div></div></div>";s.innerHTML+='<div class="details hidden"><h2>'+t.title+'</h2><div class="meta"><span class="likes"></span> '+t.likes_count+' <span class="views"></span> '+t.views_count+' <span class="comments"></span> '+t.comments_count+'</div><div class="author"><div class="author-image"><img src="'+t.player.avatar_url+'" height="50"></div><div class="author-name">'+t.player.name+"</div></div></div>";r.appendChild(i);r.appendChild(s);return r},d=function(e,t){var n=document.createElement("div"),r=document.createElement("div");n.className="page last";t<1&&(n.style.visibility="hidden");if(e.image_url&&e.title){var i=document.createElement("img");r.className="front";i.height=240;i.width=320;i.src=e.image_url;i.alt=e.title;i.className="shot";r.appendChild(i);r.innerHTML+='<div class="details hidden"><h2>'+e.title+'</h2><div class="meta"><span class="likes"></span> '+e.likes_count+' <span class="views"></span> '+e.views_count+' <span class="comments"></span> '+e.comments_count+'</div><div class="author"><div class="author-image"><img src="'+e.player.avatar_url+'" height="50"></div><div class="author-name">'+e.player.name+"</div></div></div>"}else{r.className="front text";r.innerHTML="END"}n.appendChild(r);return n},v=function(e){var t=document.createElement("img"),n=document.createElement("div");n.className="back";t.height=240;t.width=320;t.src=e.image_url;t.alt=e.title;t.className="shot";n.appendChild(t);n.innerHTML+='<div class="details hidden"><h2>'+e.title+'</h2><div class="meta"><span class="likes"></span> '+e.likes_count+' <span class="views"></span> '+e.views_count+' <span class="comments"></span> '+e.comments_count+'</div><div class="author"><div class="author-image"><img src="'+e.player.avatar_url+'" height="50"></div><div class="author-name">'+e.player.name+"</div></div></div>";return n};f();n.page===1?l():c()},s=function(){var n=1,i=!1,s,a,f,l,c,h,p=function(){if(n>2){t[n-3].style.visibility="hidden";t[n-3].style.zIndex=""}if(n>1){t[n-2].style.zIndex=1;t[n-2].style.visibility=""}t[n-1].style.zIndex=2;t.length-n>1&&(t[n+1].style.zIndex=2);t.length-n>2&&(t[n+2].style.cssText="z-index: 1;");t.length-n>3&&(t[n+3].style.cssText="visibility: hidden;")},d=function(e){s=e.targetTouches[0].pageY;a=e.targetTouches[0].pageX;f=0;l=0;c=0;h=(new Date).getTime()},v=function(e){e.preventDefault();f=s-e.targetTouches[0].pageY;l=a-e.targetTouches[0].pageX;if(f>0&&Math.abs(l)<Math.abs(f)){o.disable();u.disable();if(n<t.length-1){c=Math.min(Math.max((f-20)*.55,0),180);t[n].style.webkitTransition="";t[n].style.webkitTransform="rotateX("+c+"deg)";t[n].style.zIndex=3;if(n===1){t[0].style.webkitTransition="";t[0].style.webkitTransform=""}else t[n-1].style.webkitTransform="rotateX(180deg) translateZ(0)";if(!i){p();i=!0}}if(n===t.length-1){c=Math.min(-Math.log(f)*25+75,0);t[n].style.webkitTransition="";t[n].style.webkitTransform="rotateX("+ -c+"deg)"}}if(f<0&&Math.abs(l)<Math.abs(f)){o.disable();u.disable();if(n!==1){c=Math.max(Math.min((340+f)*.55,180),0);t[n-1].style.webkitTransition="";t[n-1].style.webkitTransform="rotateX("+c+"deg)";t[n-1].style.zIndex=3}if(n===1){c=Math.min(-Math.log(-f)*25+75,0);t[0].style.webkitTransition="";t[0].style.webkitTransform="rotateX("+c+"deg)"}t[n].style.webkitTransform="rotateX(0deg)"}},m=function(e){n===t.length-1&&r.more(n);var s=(new Date).getTime()-h;if(n===1&&c<0&&f<0){t[n-1].style.webkitTransition="all ease-out .6s";t[n-1].style.webkitTransform="rotateX(0deg) translateZ(0)"}if((c>=90||s<=500)&&f>0&&n<t.length-1&&Math.abs(l)<Math.abs(f)){t[n].style.webkitTransition="all ease-out .4s";t[n].style.webkitTransform="rotateX(180deg) translateZ(0)";n++}if(c<90&&(s>500||n===t.length-1)&&f>0){t[n].style.webkitTransition="all ease-out .6s";t[n].style.webkitTransform="rotateX(0deg)"}if((c<90||s<500)&&f<0&&n!==1&&Math.abs(l)<Math.abs(f)){t[n-1].style.webkitTransition="all ease-out .4s";t[n-1].style.webkitTransform="rotateX(0deg)";n--;p()}if(c>=90&&s>500&&f<0&&n!==1){t[n-1].style.webkitTransition="all ease-out .6s";t[n-1].style.webkitTransform="rotateX(180deg) translateZ(0)"}i=!1;h=0;o.enable();u.enable()},g=function(){e.addEventListener("touchstart",d,!1);e.addEventListener("touchmove",v,!1);e.addEventListener("touchend",m,!1)},y=function(){e.removeEventListener("touchstart",d);e.removeEventListener("touchmove",v);e.removeEventListener("touchend",m)},b=function(){n=1};return{enable:g,disable:y,reset:b}}(),o=function(){var t,n,r,i,o="center",a=function(e){t=e.targetTouches[0].pageY;n=e.targetTouches[0].pageX;r=0;i=0},f=function(e){e.preventDefault();r=t-e.targetTouches[0].pageY;i=n-e.targetTouches[0].pageX},l=function(e){o==="center"&&Math.abs(i)>Math.abs(r)&&i<-50&&c();o==="right"&&Math.abs(i)>Math.abs(r)&&i>0&&h()},c=function(){e.style.webkitTransform="translateX(240px) translateZ(0)";s.disable();u.disable();o="right"},h=function(){e.style.webkitTransform="translateX(0px) translateZ(0)";s.enable();u.enable();o="center"},p=function(){e.addEventListener("touchstart",a,!1);e.addEventListener("touchmove",f,!1);e.addEventListener("touchend",l,!1)},d=function(){e.removeEventListener("touchstart",a);e.removeEventListener("touchmove",f);e.removeEventListener("touchend",l)};return{enable:p,disable:d,right:c,center:h}}(),u=function(){var t=function(e){if(e.target.classList.contains("shot")){e.target.classList.toggle("hide");e.target.nextElementSibling.classList.toggle("hidden")}},n=function(){var n=e.getElementsByClassName("front"),r=e.getElementsByClassName("back"),i=0;for(;i<n.length;i++)n[i].addEventListener("click",t,!1);for(i=0;i<r.length;i++)r[i].addEventListener("click",t,!1)},r=function(){var n=e.getElementsByClassName("front"),r=e.getElementsByClassName("back"),i=0;for(;i<n.length;i++)n[i].removeEventListener("click",t);for(i=0;i<r.length;i++)r[i].removeEventListener("click",t)};return{enable:n,disable:r}}(),a=function(){function o(e){var n=document.createElement("script"),r=!1;n.src=e;n.async=!0;n.onload=n.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){r=!0;n.onload=n.onreadystatechange=null;n&&n.parentNode&&n.parentNode.removeChild(n)}};t||(t=document.getElementsByTagName("head")[0]);t.appendChild(n)}function u(e){return encodeURIComponent(e)}function a(t,r,a,f){n=(t||"").indexOf("?")===-1?"?":"&";r=r||{};for(var l in r)r.hasOwnProperty(l)&&(n+=u(l)+"="+u(r[l])+"&");var c="json"+ ++e;i[c]=function(e){a(e);try{delete i[c]}catch(t){}i[c]=null};o(t+n+(f||s.callbackName||"callback")+"="+c);return c}function f(e){s=e}var e=0,t,n,r,i=this,s={};return{get:a,init:f}}();return{init:n}}();document.addEventListener("DOMContentLoaded",function(){!navigator.standalone&&navigator.platform!=="iPhone"&&flibbble.init()});